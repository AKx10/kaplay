{
  "version": 3,
  "sources": ["../../src/plugins/pedit.ts"],
  "sourcesContent": ["// load pedit\n// https://github.com/slmjkdbtl/pedit.js\n\nmodule.exports = (k) => {\n\nfunction loadImg(src) {\n\n\tconst img = new Image();\n\n\timg.crossOrigin = \"\";\n\timg.src = src;\n\n\treturn new Promise((resolve, reject) => {\n\t\timg.onload = () => {\n\t\t\tresolve(img);\n\t\t};\n\t\timg.onerror = () => {\n\t\t\treject();\n\t\t};\n\t});\n\n}\n\nfunction loadPedit(name, src) {\n\n\tconst loader = k.newLoader();\n\n\treturn new Promise((resolve, reject) => {\n\n\t\tfetch(k.loadRoot() + src)\n\t\t\t.then((res) => {\n\t\t\t\treturn res.json();\n\t\t\t})\n\t\t\t.then(async (data) => {\n\n\t\t\t\tconst images = await Promise.all(data.frames.map(loadImg));\n\t\t\t\tconst canvas = document.createElement(\"canvas\");\n\t\t\t\tcanvas.width = data.width;\n\t\t\t\tcanvas.height = data.height * data.frames.length;\n\n\t\t\t\tconst ctx = canvas.getContext(\"2d\");\n\n\t\t\t\timages.forEach((img, i) => {\n\t\t\t\t\tctx.drawImage(img, 0, i * data.height);\n\t\t\t\t});\n\n\t\t\t\treturn k.loadSprite(name, canvas, {\n\t\t\t\t\tsliceY: data.frames.length,\n\t\t\t\t\tanims: data.anims,\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then((sprite) => {\n\t\t\t\tresolve(sprite);\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\terror(`failed to load sprite '${name}' from '${src}'`);\n\t\t\t\treject();\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tloader.done();\n\t\t\t});\n\n\t});\n\n}\n\nreturn {\n\tloadPedit,\n};\n\n};\n"],
  "mappings": "iSAAA,gBAGA,EAAO,QAAU,AAAC,GAAM,CAExB,WAAiB,EAAK,CAErB,GAAM,GAAM,GAAI,OAEhB,SAAI,YAAc,GAClB,EAAI,IAAM,EAEH,GAAI,SAAQ,CAAC,EAAS,IAAW,CACvC,EAAI,OAAS,IAAM,CAClB,EAAQ,IAET,EAAI,QAAU,IAAM,CACnB,OAMH,WAAmB,EAAM,EAAK,CAE7B,GAAM,GAAS,EAAE,YAEjB,MAAO,IAAI,SAAQ,CAAC,EAAS,IAAW,CAEvC,MAAM,EAAE,WAAa,GACnB,KAAK,AAAC,GACC,EAAI,QAEX,KAAK,AAAO,GAAS,wBAErB,GAAM,GAAS,KAAM,SAAQ,IAAI,EAAK,OAAO,IAAI,IAC3C,EAAS,SAAS,cAAc,UACtC,EAAO,MAAQ,EAAK,MACpB,EAAO,OAAS,EAAK,OAAS,EAAK,OAAO,OAE1C,GAAM,GAAM,EAAO,WAAW,MAE9B,SAAO,QAAQ,CAAC,EAAK,IAAM,CAC1B,EAAI,UAAU,EAAK,EAAG,EAAI,EAAK,UAGzB,EAAE,WAAW,EAAM,EAAQ,CACjC,OAAQ,EAAK,OAAO,OACpB,MAAO,EAAK,WAGb,KAAK,AAAC,GAAW,CACjB,EAAQ,KAER,MAAM,IAAM,CACZ,MAAM,0BAA0B,YAAe,MAC/C,MAEA,QAAQ,IAAM,CACd,EAAO,WAOX,MAAO,CACN",
  "names": []
}
