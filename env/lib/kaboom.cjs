var lt=Object.defineProperty,dr=Object.defineProperties;var lr=Object.getOwnPropertyDescriptors;var ht=Object.getOwnPropertySymbols;var hr=Object.prototype.hasOwnProperty,fr=Object.prototype.propertyIsEnumerable;var ft=(e,t,s)=>t in e?lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,me=(e,t)=>{for(var s in t||(t={}))hr.call(t,s)&&ft(e,s,t[s]);if(ht)for(var s of ht(t))fr.call(t,s)&&ft(e,s,t[s]);return e},ve=(e,t)=>dr(e,lr(t));var n=(e,t)=>lt(e,"name",{value:t,configurable:!0});var mt=(e,t,s)=>new Promise((i,p)=>{var C=E=>{try{A(s.next(E))}catch(y){p(y)}},v=E=>{try{A(s.throw(E))}catch(y){p(y)}},A=E=>E.done?i(E.value):Promise.resolve(E.value).then(C,v);A((s=s.apply(e,t)).next())}),pt=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return s=>{for(var i=s.length,p=new Uint8Array((i-(s[i-1]=="=")-(s[i-2]=="="))*3/4|0),C=0,v=0;C<i;){var A=e[s.charCodeAt(C++)],E=e[s.charCodeAt(C++)],y=e[s.charCodeAt(C++)],_=e[s.charCodeAt(C++)];p[v++]=A<<2|E>>4,p[v++]=E<<4|y>>2,p[v++]=y<<6|_}return p}})();function Ut(e){return e*Math.PI/180}n(Ut,"deg2rad");function gt(e){return e*180/Math.PI}n(gt,"rad2deg");function ce(e,t,s){return t>s?ce(e,s,t):Math.min(Math.max(e,t),s)}n(ce,"clamp");function Ve(e,t,s){return e+(t-e)*s}n(Ve,"lerp");function Re(e,t,s,i,p){return i+(e-t)/(s-t)*(p-i)}n(Re,"map");function bt(e,t,s,i,p){return ce(Re(e,t,s,i,p),i,p)}n(bt,"mapc");function l(...e){if(e.length===0)return l(0,0);if(e.length===1){if(typeof e[0]=="number")return l(e[0],e[0]);if(Ae(e[0]))return l(e[0].x,e[0].y);if(Array.isArray(e[0])&&e[0].length===2)return l.apply(null,e[0])}return{x:e[0],y:e[1],clone(){return l(this.x,this.y)},add(...t){let s=l(...t);return l(this.x+s.x,this.y+s.y)},sub(...t){let s=l(...t);return l(this.x-s.x,this.y-s.y)},scale(...t){let s=l(...t);return l(this.x*s.x,this.y*s.y)},dist(...t){let s=l(...t);return Math.sqrt((this.x-s.x)*(this.x-s.x)+(this.y-s.y)*(this.y-s.y))},len(){return this.dist(l(0,0))},unit(){return this.scale(1/this.len())},normal(){return l(this.y,-this.x)},dot(t){return this.x*t.x+this.y*t.y},angle(...t){let s=l(...t);return Math.atan2(this.y-s.y,this.x-s.x)},lerp(t,s){return l(Ve(this.x,t.x,s),Ve(this.y,t.y,s))},toFixed(t){return l(this.x.toFixed(t),this.y.toFixed(t))},eq(t){return this.x===t.x&&this.y===t.y},str(){return`(${this.x}, ${this.y})`}}}n(l,"vec2");function xt(e){return l(Math.cos(e),Math.sin(e))}n(xt,"vec2FromAngle");function pe(e,t,s){return{x:e,y:t,z:s,xy(){return l(this.x,this.y)}}}n(pe,"vec3");function Ae(e){return e!==void 0&&e.x!==void 0&&e.y!==void 0}n(Ae,"isVec2");function yt(e){return e!==void 0&&e.x!==void 0&&e.y!==void 0&&e.z!==void 0}n(yt,"isVec3");function Ee(e){return e!==void 0&&e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0}n(Ee,"isColor");function wt(e){if(e!==void 0&&Array.isArray(e.m)&&e.m.length===16)return e}n(wt,"isMat4");function Te(...e){if(e.length===0)return $();if(e.length===1){if(Ee(e[0]))return $(e[0]);if(Array.isArray(e[0])&&e[0].length===3)return Te.apply(null,e[0])}return $(e[0],e[1],e[2],1)}n(Te,"rgb");function $(...e){var t;if(e.length===0)return $(1,1,1,1);if(e.length===1){if(Ee(e[0]))return $(e[0].r,e[0].g,e[0].b,e[0].a);if(Array.isArray(e[0])&&e[0].length===4)return $.apply(null,e[0])}return{r:e[0],g:e[1],b:e[2],a:(t=e[3])!=null?t:1,clone(){return $(this.r,this.g,this.b,this.a)},lighten(s){return $(this.r+s,this.g+s,this.b+s,this.a)},darken(s){return this.lighten(-s)},invert(){return $(1-this.r,1-this.g,1-this.b,this.a)},isDark(s=.5){return this.r+this.g+this.b<3*s},isLight(s=.5){return this.r+this.g+this.b>3*s},eq(s){return this.r===s.r&&this.g===s.g&&this.b===s.g&&this.a===s.a}}}n($,"rgba");function ne(e,t,s,i){return{x:e,y:t,w:s,h:i,scale(p){return ne(this.x+this.w*p.x,this.y+this.h*p.y,this.w*p.w,this.h*p.h)},clone(){return ne(this.x,this.y,this.w,this.h)},eq(p){return this.x===p.x&&this.y===p.y&&this.w===p.w&&this.h===p.h}}}n(ne,"quad");function ee(e){return{m:e?[...e]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],clone(){return ee(this.m)},mult(t){let s=[];for(let i=0;i<4;i++)for(let p=0;p<4;p++)s[i*4+p]=this.m[0*4+p]*t.m[i*4+0]+this.m[1*4+p]*t.m[i*4+1]+this.m[2*4+p]*t.m[i*4+2]+this.m[3*4+p]*t.m[i*4+3];return ee(s)},multVec4(t){return{x:t.x*this.m[0]+t.y*this.m[4]+t.z*this.m[8]+t.w*this.m[12],y:t.x*this.m[1]+t.y*this.m[5]+t.z*this.m[9]+t.w*this.m[13],z:t.x*this.m[2]+t.y*this.m[6]+t.z*this.m[10]+t.w*this.m[14],w:t.x*this.m[3]+t.y*this.m[7]+t.z*this.m[11]+t.w*this.m[15]}},multVec3(t){let s=this.multVec4({x:t.x,y:t.y,z:t.z,w:1});return pe(s.x,s.y,s.z)},multVec2(t){return l(t.x*this.m[0]+t.y*this.m[4]+0*this.m[8]+1*this.m[12],t.x*this.m[1]+t.y*this.m[5]+0*this.m[9]+1*this.m[13])},translate(t){return this.mult(ee([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,0,1]))},scale(t){return this.mult(ee([t.x,0,0,0,0,t.y,0,0,0,0,1,0,0,0,0,1]))},rotateX(t){return this.mult(ee([1,0,0,0,0,Math.cos(t),-Math.sin(t),0,0,Math.sin(t),Math.cos(t),0,0,0,0,1]))},rotateY(t){return this.mult(ee([Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1]))},rotateZ(t){return this.mult(ee([Math.cos(t),-Math.sin(t),0,0,Math.sin(t),Math.cos(t),0,0,0,0,1,0,0,0,0,1]))},invert(){let t=[],s=this.m[10]*this.m[15]-this.m[14]*this.m[11],i=this.m[9]*this.m[15]-this.m[13]*this.m[11],p=this.m[9]*this.m[14]-this.m[13]*this.m[10],C=this.m[8]*this.m[15]-this.m[12]*this.m[11],v=this.m[8]*this.m[14]-this.m[12]*this.m[10],A=this.m[8]*this.m[13]-this.m[12]*this.m[9],E=this.m[6]*this.m[15]-this.m[14]*this.m[7],y=this.m[5]*this.m[15]-this.m[13]*this.m[7],_=this.m[5]*this.m[14]-this.m[13]*this.m[6],G=this.m[4]*this.m[15]-this.m[12]*this.m[7],T=this.m[4]*this.m[14]-this.m[12]*this.m[6],P=this.m[5]*this.m[15]-this.m[13]*this.m[7],I=this.m[4]*this.m[13]-this.m[12]*this.m[5],z=this.m[6]*this.m[11]-this.m[10]*this.m[7],M=this.m[5]*this.m[11]-this.m[9]*this.m[7],q=this.m[5]*this.m[10]-this.m[9]*this.m[6],B=this.m[4]*this.m[11]-this.m[8]*this.m[7],c=this.m[4]*this.m[10]-this.m[8]*this.m[6],X=this.m[4]*this.m[9]-this.m[8]*this.m[5];t[0]=this.m[5]*s-this.m[6]*i+this.m[7]*p,t[4]=-(this.m[4]*s-this.m[6]*C+this.m[7]*v),t[8]=this.m[4]*i-this.m[5]*C+this.m[7]*A,t[12]=-(this.m[4]*p-this.m[5]*v+this.m[6]*A),t[1]=-(this.m[1]*s-this.m[2]*i+this.m[3]*p),t[5]=this.m[0]*s-this.m[2]*C+this.m[3]*v,t[9]=-(this.m[0]*i-this.m[1]*C+this.m[3]*A),t[13]=this.m[0]*p-this.m[1]*v+this.m[2]*A,t[2]=this.m[1]*E-this.m[2]*y+this.m[3]*_,t[6]=-(this.m[0]*E-this.m[2]*G+this.m[3]*T),t[10]=this.m[0]*P-this.m[1]*G+this.m[3]*I,t[14]=-(this.m[0]*_-this.m[1]*T+this.m[2]*I),t[3]=-(this.m[1]*z-this.m[2]*M+this.m[3]*q),t[7]=this.m[0]*z-this.m[2]*B+this.m[3]*c,t[11]=-(this.m[0]*M-this.m[1]*B+this.m[3]*X),t[15]=this.m[0]*q-this.m[1]*c+this.m[2]*X;let H=this.m[0]*t[0]+this.m[1]*t[4]+this.m[2]*t[8]+this.m[3]*t[12];for(let N=0;N<4;N++)for(let oe=0;oe<4;oe++)t[N*4+oe]*=1/H;return ee(t)}}}n(ee,"mat4");function vt(e,t,s){return e+(Math.sin(s)+1)/2*(t-e)}n(vt,"wave");var mr=1103515245,pr=12345,Et=2147483648,Je=et(Date.now());function et(e){return{seed:e,gen(...t){if(t.length===0)return this.seed=(mr*this.seed+pr)%Et,this.seed/Et;if(t.length===1){if(typeof t[0]=="number")return this.gen(0,t[0]);if(Ae(t[0]))return this.gen(l(0,0),t[0]);if(Ee(t[0]))return this.gen($(0,0,0,0),t[0])}else if(t.length===2){if(typeof t[0]=="number"&&typeof t[1]=="number")return this.gen()*(t[1]-t[0])+t[0];if(Ae(t[0])&&Ae(t[1]))return l(this.gen(t[0].x,t[1].x),this.gen(t[0].y,t[1].y));if(Ee(t[0])&&Ee(t[1]))return $(this.gen(t[0].r,t[1].r),this.gen(t[0].g,t[1].g),this.gen(t[0].b,t[1].b),this.gen(t[0].a,t[1].a))}}}}n(et,"makeRng");function Tt(e){return e!=null&&(Je.seed=e),Je.seed}n(Tt,"randSeed");function Be(...e){return Je.gen(...e)}n(Be,"rand");function Ct(e){return Be()<=e}n(Ct,"chance");function Dt(e){return e[Math.floor(Be(e.length))]}n(Dt,"choose");function tt(e,t){return e.p2.x>=t.p1.x&&e.p1.x<=t.p2.x&&e.p2.y>=t.p1.y&&e.p1.y<=t.p2.y}n(tt,"colRectRect");function Pt(e,t){return e.p2.x>t.p1.x&&e.p1.x<t.p2.x&&e.p2.y>t.p1.y&&e.p1.y<t.p2.y}n(Pt,"overlapRectRect");function St(e,t){return t.x>=e.p1.x&&t.x<=e.p2.x&&t.y>=e.p1.y&&t.y<e.p2.y}n(St,"colRectPt");function rt(e,t){let s=typeof e,i=typeof t;if(s!==i)return!1;if(s==="object"&&i==="object"){let p=Object.keys(e),C=Object.keys(t);if(p.length!==C.length)return!1;for(let v of p){let A=e[v],E=t[v];if(!(typeof A=="function"&&typeof E=="function")&&!rt(A,E))return!1}return!0}return e===t}n(rt,"deepEq");var Qe="topleft",qe=9,We=65536,Rt=64,Ur=`
attribute vec3 a_pos;
attribute vec2 a_uv;
attribute vec4 a_color;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

vec4 def_vert() {
	return vec4(a_pos, 1.0);
}

{{user}}

void main() {
	vec4 pos = vert(a_pos, a_uv, a_color);
	v_pos = a_pos;
	v_uv = a_uv;
	v_color = a_color;
	gl_Position = pos;
}
`,gr=`
precision mediump float;

varying vec3 v_pos;
varying vec2 v_uv;
varying vec4 v_color;

uniform sampler2D u_tex;

vec4 def_frag() {
	return v_color * texture2D(u_tex, v_uv);
}

{{user}}

void main() {
	gl_FragColor = frag(v_pos, v_uv, v_color, u_tex);
	if (gl_FragColor.a == 0.0) {
		discard;
	}
}
`,nt=`
vec4 vert(vec3 pos, vec2 uv, vec4 color) {
	return def_vert();
}
`,ot=`
vec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {
	return def_frag();
}
`;function _e(e){switch(e){case"topleft":return l(-1,-1);case"top":return l(0,-1);case"topright":return l(1,-1);case"left":return l(-1,0);case"center":return l(0,0);case"right":return l(1,0);case"botleft":return l(-1,1);case"bot":return l(0,1);case"botright":return l(1,1);default:return e}}n(_e,"originPt");function At(e,t){let s=(()=>{switch(t.texFilter){case"linear":return e.LINEAR;case"nearest":return e.NEAREST;default:return e.NEAREST}})(),i=(()=>{var j;let m=v(nt,ot),U=C(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),b=(j=t.clearColor)!=null?j:$(0,0,0,1);e.clearColor(b.r,b.g,b.b,b.a),e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);let R=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,R),e.bufferData(e.ARRAY_BUFFER,We*4,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);let F=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,F),e.bufferData(e.ELEMENT_ARRAY_BUFFER,We*2,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);let k=C(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2));return{drawCalls:0,lastDrawCalls:0,defProg:m,curProg:m,defTex:U,curTex:U,curUniform:{},vbuf:R,ibuf:F,vqueue:[],iqueue:[],transform:ee(),transformStack:[],clearColor:b,bgTex:k}})();_(),G();function p(m){return Math.log(m)/Math.log(2)%1==0}n(p,"powerOfTwo");function C(m){let U=e.createTexture();e.bindTexture(e.TEXTURE_2D,U),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,m),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,s);let b=(()=>p(m.width)&&p(m.height)?e.REPEAT:e.CLAMP_TO_EDGE)();return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,b),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,b),e.bindTexture(e.TEXTURE_2D,null),{width:m.width,height:m.height,bind(){e.bindTexture(e.TEXTURE_2D,U)},unbind(){e.bindTexture(e.TEXTURE_2D,null)}}}n(C,"makeTex");function v(m=nt,U=ot){let b,R=Ur.replace("{{user}}",m!=null?m:nt),F=gr.replace("{{user}}",U!=null?U:ot),k=e.createShader(e.VERTEX_SHADER),j=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(k,R),e.shaderSource(j,F),e.compileShader(k),e.compileShader(j),b=e.getShaderInfoLog(k))throw new Error(b);if(b=e.getShaderInfoLog(j))throw new Error(b);let L=e.createProgram();if(e.attachShader(L,k),e.attachShader(L,j),e.bindAttribLocation(L,0,"a_pos"),e.bindAttribLocation(L,1,"a_uv"),e.bindAttribLocation(L,2,"a_color"),e.linkProgram(L),(b=e.getProgramInfoLog(L))&&b!==`
`)throw new Error(b);return{bind(){e.useProgram(L)},unbind(){e.useProgram(null)},bindAttribs(){e.vertexAttribPointer(0,3,e.FLOAT,!1,qe*4,0),e.enableVertexAttribArray(0),e.vertexAttribPointer(1,2,e.FLOAT,!1,qe*4,12),e.enableVertexAttribArray(1),e.vertexAttribPointer(2,4,e.FLOAT,!1,qe*4,20),e.enableVertexAttribArray(2)},send(S){this.bind();for(let W in S){let O=S[W],Q=e.getUniformLocation(L,W);typeof O=="number"?e.uniform1f(Q,O):wt(O)?e.uniformMatrix4fv(Q,!1,new Float32Array(O.m)):Ee(O)?e.uniform4f(Q,O.r,O.g,O.b,O.a):yt(O)?e.uniform3f(Q,O.x,O.y,O.z):Ae(O)&&e.uniform2f(Q,O.x,O.y)}this.unbind()}}}n(v,"makeProgram");function A(m,U,b,R){let F=m.width/U,k=m.height/b,j=1/F,L=1/k,S={},W=R.split("").entries();for(let[O,Q]of W)S[Q]=l(O%F*j,Math.floor(O/F)*L);return{tex:m,map:S,qw:j,qh:L}}n(A,"makeFont");function E(m,U,b=i.defTex,R=i.defProg,F={}){b=b!=null?b:i.defTex,R=R!=null?R:i.defProg,(b!==i.curTex||R!==i.curProg||!rt(i.curUniform,F)||i.vqueue.length+m.length*qe>We||i.iqueue.length+U.length>We)&&y(),i.curTex=b,i.curProg=R,i.curUniform=F;let k=U.map(L=>L+i.vqueue.length/qe),j=m.map(L=>{let S=P(i.transform.multVec2(L.pos.xy()));return[S.x,S.y,L.pos.z,L.uv.x,L.uv.y,L.color.r,L.color.g,L.color.b,L.color.a]}).flat();k.forEach(L=>i.iqueue.push(L)),j.forEach(L=>i.vqueue.push(L))}n(E,"drawRaw");function y(){!i.curTex||!i.curProg||i.vqueue.length===0||i.iqueue.length===0||(i.curProg.send(i.curUniform),e.bindBuffer(e.ARRAY_BUFFER,i.vbuf),e.bufferSubData(e.ARRAY_BUFFER,0,new Float32Array(i.vqueue)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.ibuf),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(i.iqueue)),i.curProg.bind(),i.curProg.bindAttribs(),i.curTex.bind(),e.drawElements(e.TRIANGLES,i.iqueue.length,e.UNSIGNED_SHORT,0),i.curTex.unbind(),i.curProg.unbind(),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),i.iqueue=[],i.vqueue=[],i.drawCalls++)}n(y,"flush");function _(){e.clear(e.COLOR_BUFFER_BIT),t.clearColor||N({width:re(),height:ge(),quad:ne(0,0,re()*ye()/Rt,ge()*ye()/Rt),tex:i.bgTex}),i.drawCalls=0,i.transformStack=[],i.transform=ee()}n(_,"frameStart");function G(){y(),i.lastDrawCalls=i.drawCalls}n(G,"frameEnd");function T(){return i.lastDrawCalls}n(T,"drawCalls");function P(m){return l(m.x/re()*2-1,-m.y/ge()*2+1)}n(P,"toNDC");function I(m){i.transform=m.clone()}n(I,"pushMatrix");function z(m){!m||m.x===0&&m.y===0||(i.transform=i.transform.translate(m))}n(z,"pushTranslate");function M(m){!m||m.x===1&&m.y===1||(i.transform=i.transform.scale(m))}n(M,"pushScale");function q(m){!m||(i.transform=i.transform.rotateX(m))}n(q,"pushRotateX");function B(m){!m||(i.transform=i.transform.rotateY(m))}n(B,"pushRotateY");function c(m){!m||(i.transform=i.transform.rotateZ(m))}n(c,"pushRotateZ");function X(){i.transformStack.push(i.transform.clone())}n(X,"pushTransform");function H(){i.transformStack.length>0&&(i.transform=i.transformStack.pop())}n(H,"popTransform");function N(m={}){var Q,J;let U=m.width||0,b=m.height||0,R=m.pos||l(0,0),k=_e(m.origin||Qe).scale(l(U,b).scale(-.5)),j=l((Q=m.scale)!=null?Q:1),L=m.rot||0,S=m.quad||ne(0,0,1,1),W=1-((J=m.z)!=null?J:0),O=m.color||$(1,1,1,1);X(),z(R),c(L),M(j),z(k),E([{pos:pe(-U/2,b/2,W),uv:l(m.flipX?S.x+S.w:S.x,m.flipY?S.y:S.y+S.h),color:O},{pos:pe(-U/2,-b/2,W),uv:l(m.flipX?S.x+S.w:S.x,m.flipY?S.y+S.h:S.y),color:O},{pos:pe(U/2,-b/2,W),uv:l(m.flipX?S.x:S.x+S.w,m.flipY?S.y+S.h:S.y),color:O},{pos:pe(U/2,b/2,W),uv:l(m.flipX?S.x:S.x+S.w,m.flipY?S.y:S.y+S.h),color:O}],[0,1,3,1,2,3],m.tex,m.prog,m.uniform),H()}n(N,"drawQuad");function oe(m,U={}){var j;let b=(j=U.quad)!=null?j:ne(0,0,1,1),R=m.width*b.w,F=m.height*b.h,k=l(1);if(U.tiled){let L=Math.ceil((U.width||R)/R),S=Math.ceil((U.height||F)/F),O=_e(U.origin||Qe).add(l(1,1)).scale(.5).scale(L*R,S*F);for(let Q=0;Q<L;Q++)for(let J=0;J<S;J++)N(ve(me({},U),{pos:(U.pos||l(0)).add(l(R*Q,F*J)).sub(O),scale:k.scale(U.scale||l(1)),tex:m,quad:b,width:R,height:F,origin:"topleft"}))}else U.width&&U.height?(k.x=U.width/R,k.y=U.height/F):U.width?(k.x=U.width/R,k.y=k.x):U.height&&(k.y=U.height/F,k.x=k.y),N(ve(me({},U),{scale:k.scale(U.scale||l(1)),tex:m,quad:b,width:R,height:F}))}n(oe,"drawTexture");function de(m,U,b,R={}){N(ve(me({},R),{pos:m,width:U,height:b}))}n(de,"drawRect");function le(m,U,b,R={}){let F=_e(R.origin||Qe).scale(l(U,b)).scale(.5),k=m.add(l(-U/2,-b/2)).sub(F),j=m.add(l(-U/2,b/2)).sub(F),L=m.add(l(U/2,b/2)).sub(F),S=m.add(l(U/2,-b/2)).sub(F);w(k,j,R),w(j,L,R),w(L,S,R),w(S,k,R)}n(le,"drawRectStroke");function w(m,U,b={}){let R=b.width||1,F=m.dist(U),k=Math.PI/2-m.angle(U);N(ve(me({},b),{pos:m.add(U).scale(.5),width:R,height:F,rot:k,origin:"center"}))}n(w,"drawLine");function V(m,U,b,R={}){let F=R.z,k=R.color||Te(1,1,1);E([{pos:pe(m.x,m.y,F),uv:l(0,0),color:k},{pos:pe(U.x,U.y,F),uv:l(0,0),color:k},{pos:pe(b.x,b.y,F),uv:l(0,0),color:k}],[0,1,2],i.defTex,R.prog,R.uniform)}n(V,"drawTri");function te(m,U,b={}){let R=(m+"").split(""),F=U.qw*U.tex.width,k=U.qh*U.tex.height,j=b.size||k,L=l(j/k).scale(l(b.scale||1)),S=L.x*F,W=L.y*k,O=0,Q=W,J=0,De=[],ie=[],se=null,ae=0;for(;ae<R.length;){let ue=R[ae];ue===`
`?(Q+=W,O=0,se=null,De.push(ie),ie=[]):(b.width?O+S>b.width:!1)&&(Q+=W,O=0,se!=null&&(ae-=ie.length-se,ue=R[ae],ie=ie.slice(0,se)),se=null,De.push(ie),ie=[]),ue!==`
`&&(ie.push(ue),O+=S,ue===" "&&(se=ie.length)),J=Math.max(J,O),ae++}De.push(ie),b.width&&(J=b.width);let Pe=[],he=l(b.pos||0),we=_e(b.origin||Qe).scale(.5),He=-we.x*S-(we.x+.5)*(J-S),Ne=-we.y*W-(we.y+.5)*(Q-W);return De.forEach((ue,Ie)=>{let Le=(J-ue.length*S)*(we.x+.5);ue.forEach((ke,Ye)=>{let fe=U.map[ke],Se=Ye*S,Me=Ie*W;fe&&Pe.push({tex:U.tex,quad:ne(fe.x,fe.y,U.qw,U.qh),ch:ke,pos:l(he.x+Se+He+Le,he.y+Me+Ne),color:b.color,origin:b.origin,scale:L,z:b.z})})}),{width:J,height:Q,chars:Pe}}n(te,"fmtText");function Ce(m,U,b={}){Ue(te(m,U,b))}n(Ce,"drawText");function Ue(m){for(let U of m.chars)N({tex:U.tex,width:U.tex.width*U.quad.w,height:U.tex.height*U.quad.h,pos:U.pos,scale:U.scale,color:U.color,quad:U.quad,origin:"center",z:U.z})}n(Ue,"drawFmtText");function re(){return e.drawingBufferWidth/ye()}n(re,"width");function ge(){return e.drawingBufferHeight/ye()}n(ge,"height");function ye(){var m;return(m=t.scale)!=null?m:1}n(ye,"scale");function Ke(){return i.clearColor.clone()}return n(Ke,"clearColor"),{width:re,height:ge,scale:ye,makeTex:C,makeProgram:v,makeFont:A,drawTexture:oe,drawText:Ce,drawFmtText:Ue,drawRect:de,drawRectStroke:le,drawLine:w,drawTri:V,fmtText:te,frameStart:_,frameEnd:G,pushTransform:X,popTransform:H,pushMatrix:I,drawCalls:T,clearColor:Ke}}n(At,"gfxInit");function _t(e){return e==="pressed"||e==="rpressed"?"down":e==="released"?"up":e}n(_t,"processBtnState");function Ft(e={}){var de,le;let t={canvas:(de=e.canvas)!=null?de:(()=>{var V;let w=document.createElement("canvas");return((V=e.root)!=null?V:document.body).appendChild(w),w})(),keyStates:{},charInputted:[],mouseMoved:!1,mouseState:"up",mousePos:l(0,0),mouseDeltaPos:l(0,0),time:0,realTime:0,skipTime:!1,dt:0,scale:(le=e.scale)!=null?le:1,isTouch:!1,loopID:null,stopped:!1,fps:0,fpsBuf:[],fpsTimer:0},s={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},i=["space","left","right","up","down","tab","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11"];e.fullscreen?(t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight):(t.canvas.width=(e.width||640)*t.scale,t.canvas.height=(e.height||480)*t.scale);let p=["outline: none","cursor: default"];e.crisp&&(p.push("image-rendering: pixelated"),p.push("image-rendering: crisp-edges")),t.canvas.style=p.join(";"),t.canvas.setAttribute("tabindex","0");let C=t.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});t.isTouch="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,t.canvas.addEventListener("mousemove",w=>{t.mousePos=l(w.offsetX,w.offsetY).scale(1/t.scale),t.mouseDeltaPos=l(w.movementX,w.movementY).scale(1/t.scale),t.mouseMoved=!0}),t.canvas.addEventListener("mousedown",()=>{t.mouseState="pressed"}),t.canvas.addEventListener("mouseup",()=>{t.mouseState="released"}),t.canvas.addEventListener("keydown",w=>{let V=s[w.key]||w.key.toLowerCase();i.includes(V)&&w.preventDefault(),V.length===1&&t.charInputted.push(V),V==="space"&&t.charInputted.push(" "),w.repeat?t.keyStates[V]="rpressed":t.keyStates[V]="pressed"}),t.canvas.addEventListener("keyup",w=>{let V=s[w.key]||w.key.toLowerCase();t.keyStates[V]="released"}),t.canvas.addEventListener("touchstart",w=>{if(!e.touchToMouse)return;w.preventDefault();let V=w.touches[0];t.mousePos=l(V.clientX,V.clientY).scale(1/t.scale),t.mouseState="pressed"}),t.canvas.addEventListener("touchmove",w=>{if(!e.touchToMouse)return;w.preventDefault();let V=w.touches[0];t.mousePos=l(V.clientX,V.clientY).scale(1/t.scale),t.mouseMoved=!0}),t.canvas.addEventListener("touchend",w=>{!e.touchToMouse||(t.mouseState="released")}),t.canvas.addEventListener("touchcancel",w=>{!e.touchToMouse||(t.mouseState="released")}),document.addEventListener("visibilitychange",()=>{var w,V;switch(document.visibilityState){case"visible":t.skipTime=!0,(w=e.audioCtx)==null||w.resume();break;case"hidden":(V=e.audioCtx)==null||V.suspend();break}});function v(){return t.mousePos.clone()}n(v,"mousePos");function A(){return t.mouseDeltaPos.clone()}n(A,"mouseDeltaPos");function E(){return t.mouseState==="pressed"}n(E,"mouseClicked");function y(){return t.mouseState==="pressed"||t.mouseState==="down"}n(y,"mouseDown");function _(){return t.mouseState==="released"}n(_,"mouseReleased");function G(){return t.mouseMoved}n(G,"mouseMoved");function T(w){return t.keyStates[w]==="pressed"}n(T,"keyPressed");function P(w){return t.keyStates[w]==="pressed"||t.keyStates[w]==="rpressed"}n(P,"keyPressedRep");function I(w){return t.keyStates[w]==="pressed"||t.keyStates[w]==="rpressed"||t.keyStates[w]==="down"}n(I,"keyDown");function z(w){return t.keyStates[w]==="released"}n(z,"keyReleased");function M(){return[...t.charInputted]}n(M,"charInputted");function q(){return t.dt}n(q,"dt");function B(){return t.time}n(B,"time");function c(){return t.fps}n(c,"fps");function X(){return t.canvas.toDataURL()}n(X,"screenshot");function H(w){return w&&(t.canvas.style.cursor=w!=null?w:"default"),t.canvas.style.cursor}n(H,"cursor");function N(w){let V=n(te=>{let Ce=te/1e3,Ue=Ce-t.realTime;t.realTime=Ce,t.skipTime||(t.dt=Ue,t.time+=t.dt,t.fpsBuf.push(1/t.dt),t.fpsTimer+=t.dt,t.fpsTimer>=1&&(t.fpsTimer=0,t.fps=Math.round(t.fpsBuf.reduce((re,ge)=>re+ge)/t.fpsBuf.length),t.fpsBuf=[])),t.skipTime=!1,w();for(let re in t.keyStates)t.keyStates[re]=_t(t.keyStates[re]);t.mouseState=_t(t.mouseState),t.charInputted=[],t.mouseMoved=!1,t.loopID=requestAnimationFrame(V)},"frame");t.stopped=!1,t.loopID=requestAnimationFrame(V)}n(N,"run");function oe(){cancelAnimationFrame(t.loopID),t.stopped=!0}return n(oe,"quit"),{gl:C,mousePos:v,mouseDeltaPos:A,keyDown:I,keyPressed:T,keyPressedRep:P,keyReleased:z,mouseDown:y,mouseClicked:E,mouseReleased:_,mouseMoved:G,charInputted:M,cursor:H,dt:q,time:B,fps:c,screenshot:X,run:N,quit:oe,focused:()=>document.activeElement===t.canvas,focus:()=>t.canvas.focus(),canvas:t.canvas,isTouch:t.isTouch,scale:t.scale}}n(Ft,"appInit");var It=pt("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L5QNSqT5iiySS9Ja2SV//5ME0ak//+4KgAAABgQBAADAMDgYCAEgCteQ0fZH6+ICXA357+MPfhR/+ywRf/U///LVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+5JknQAFoWhGLm5gBClBmT3GiAAAAAGkHAAAIAAANIOAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");var Lt=0,kt=3,xr=0,yr=3,wr=-1200,vr=1200;function Mt(){let e=(()=>{let v=new(window.AudioContext||window.webkitAudioContext),A=v.createGain(),E=A;return E.connect(v.destination),{ctx:v,gainNode:A,masterNode:E}})(),t;e.ctx.decodeAudioData(It.buffer.slice(0),v=>{t=v},()=>{throw new Error("failed to make burp")});function s(v){return v!==void 0&&(e.gainNode.gain.value=ce(v,Lt,kt)),e.gainNode.gain.value}n(s,"volume");function i(v,A={loop:!1,volume:1,speed:1,detune:0,seek:0}){var z;let E=!1,y=e.ctx.createBufferSource();y.buffer=v,y.loop=!!A.loop;let _=e.ctx.createGain();y.connect(_),_.connect(e.masterNode);let G=(z=A.seek)!=null?z:0;y.start(0,G);let T=e.ctx.currentTime-G,P=null,I={stop(){E||(this.pause(),T=e.ctx.currentTime)},play(M){if(!E)return;let q=y;y=e.ctx.createBufferSource(),y.buffer=q.buffer,y.loop=q.loop,y.playbackRate.value=q.playbackRate.value,y.detune&&(y.detune.value=q.detune.value),y.connect(_);let B=M!=null?M:this.time();y.start(0,B),T=e.ctx.currentTime-B,E=!1,P=null},pause(){E||(y.stop(),E=!0,P=e.ctx.currentTime)},paused(){return E},stopped(){return E},speed(M){return M!==void 0&&(y.playbackRate.value=ce(M,xr,yr)),y.playbackRate.value},detune(M){return y.detune?(M!==void 0&&(y.detune.value=ce(M,wr,vr)),y.detune.value):0},volume(M){return M!==void 0&&(_.gain.value=ce(M,Lt,kt)),_.gain.value},loop(){y.loop=!0},unloop(){y.loop=!1},duration(){return v.duration},time(){return E?P-T:e.ctx.currentTime-T}};return I.speed(A.speed),I.detune(A.detune),I.volume(A.volume),I}n(i,"play");function p(){return e.ctx}n(p,"ctx");function C(v){return i(t,v)}return n(C,"burp"),{ctx:p,volume:s,play:i,burp:C}}n(Mt,"audioInit");var Gt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAvgAAAAICAYAAACML4vTAAAAAXNSR0IArs4c6QAABo1JREFUeJzdW9uO5SgMJKv9/1/OPnQnDabKVQb6zGgtjeYkvmJsYwh9tQLc931//7yu63retdba+/4hTZ6ZDMQ3wHVdPe1kXk/60He2D/J7HLMhGyOwHQKji/o/BYmv40DecRq+cfgr8l8dhBfRLPF3v6F9Cu/ObwFPYxRBFptE7mA/wQ2yWMwI/1r+y3Bq/h4H3TwJ3fl16xcz4UfQPB+oplF9QJ7id+SjMVjz/wf5e5rK+hKfB9+a86PsZTIm+7P6942jufsqSvg7/END5WSg6ojLt7uurcjL6v8pfQ4doinIL9v+f4HTMfQ3gopR5gOQ+6jviPj7EfLvqQGsQFiXb/B7KMBGc/rQ3x1ONuHmBmOQfd93XwDVguPI/3Uw/fc8Dz5s4/xMogU/xScNKILJb4W5Q/YyXtt+IWcyF+GzMajY7ehZbCK5vf2sGczmJ+J6O6J8pT8dB5HPwPU706/knsjfVRlxvhje0Zn5H+F/m/+kf6uA1oxqPVD1Jeqj+kHuRr5x0ZzzU8nJANrCalDS5A54xV9Ynyd+p/6bNXSiBfY5Dk1pkPyObzI0s10ceFr+3+FXsMq/qk+BM97TusU6bIvp+Flf1ufuy/OJBh817s/vlcKOaOHgRBOeyu0nppt4uIEA+gcboLLv96oIu18IFLhfSRooMh19hsvkKyNjkCo6R+fXC3ya/ddAdjrekxH2i8VmiH23oGTNYy+n2iBHyPhYjtWV8IJtyz38BW6a42JMKuJtn30IfgJT+PdkziayaP1W+OpX6J6HyJ+ac8MXaJEvNfnGGheVow34neAn/tag30aByRfI5PDBlZ9tzNghHuJDMnZpGO37rMam/L/Jj2w6wY/8TH1gPCNfQ3zxAJTZ3wPKkS9EIS9bm3OfbDonof9YWgw7gCJ0uqF+390/JIs1QZE+yhjkKOcifMKDdMX3kYbxKB3xn8fsNZEPPm2SBQ7KD/OkkgXZfYV/PV/U/+rok0IswDH+HDyCmAcuXs1LHP8gBzTyd487dIrgAPPfC489wK6K/GwjouYoo6nmZQXUHCtA9RThd+yX87fIn9X3T8Kkl2yC3zlS+NZK9XUClruFjU3093IcBFui8U79Zfg74Flj7dRHJJ/1Hq58xAs3JAdgNb9QDxHB9f8JfgSV+c96QaVnCcRhzx3+r+hXY9qtq1HmKy+up3Ft3T7BN06gWVDGZhI5JL4b6Mh9yolu5T6iukMN7M4KQqWZ/SKYP9+lYJyAOYtPveMy5IPdZja//XPVnkw+tBHdPe35w8kWs3UX+tjNrtggvpWvM3H8Lihi5f/dE1kVD068PL7O+Fc2z65eNseuDEfHKoxFpx4fjm9bS+LjFyEu4F8P4gras1geqq8QzK9wlJ3IWYJk3TtS8zbvV8MN2qGvaxQOXt3YafKe2NjN8U8A2hzGDQpdg37xqzurObB3dOY9uyYG8nG37pXjp9rg7wQm+v0A201GvGqUd4KfFlejgUobxCDjixAXod3NiWVfRaa6YsT0hitIWWAqXyr+JdhYBDJbSg32Y8fOFZvVDdziBq/cABPY8WEKpxf31fgnMM2xq681u9HYagAM/6mxDmM0eXaBNhCELgKt36Z+Vf9GYoDLrsg496TZ8yFg629dEL+D7sDq4FB8bIF7xTaxI2X8Q9dJWf7Y/ks2iPYGf2HsWf5HnOovUH2m4896Q9JDDs+rV7TduKs2+EcLNdnhvM/f+MqCEp8tO437h9C2YEP2nL7/5WR2G79sgYwGqo1ElJHu4F9msAkC84Lscxd4Bg5/ansGhVOAKf7MAuBu4NC8seJ1mQ0lku/okM090M/iS8HuAq/ivxJ/To1RMrDg/G8OTuVHub4e1j/wg9xBuF5fbPJVTlTsdOaPrmdiHVqK3UN/w+Xmz2r+K/mQf6G5RnauwDuHm80oGwCLkZMbHLYB/nkYm9Md/yF6NDa3SR9sNPM/0rD+cpgf8ws+qifOGN35XK2bHznBj3xWEKHTy+QT5HYiGJ83kW3lP5ZI4MTmKU1a9rcFbNyFT76OzVC+olP2tQYLEJNfGmO2iVs4AU/nd/PzejrHiM58z/BWvjnzs+J7QEvxzlcQgFupJxXfVuSjuFP11NFp4bI76IVnpZ/a7cxfRkNiIxtL9n41f1yayhrngmrG5LwYdWkp/x35h9Yg1WC6vlYNuStvKeZW+h9zfR/eIboHxD12Bml87PYgiCZZP5Z81fI5lrm5k0fxfWVj+x9lSgjp7YOOoAAAAABJRU5ErkJggg==";var Tr=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Fe="unscii";function Ot(e){let t=new Image;return t.src=e,t.crossOrigin="anonymous",new Promise((s,i)=>{t.onload=()=>{s(t)},t.onerror=()=>{i(`failed to load ${e}`)}})}n(Ot,"loadImg");function Vt(e){return e.startsWith("data:")}n(Vt,"isDataUrl");function Bt(e,t,s={}){let i={lastLoaderID:0,loadRoot:"",loaders:{},sprites:{},sounds:{},fonts:{},shaders:{}};function p(T){var I;let P=i.lastLoaderID;i.loaders[P]=!1,i.lastLoaderID++,T.catch((I=s.errHandler)!=null?I:console.error).finally(()=>i.loaders[P]=!0)}n(p,"addLoader");function C(){let T=0,P=0;for(let I in i.loaders)T+=1,i.loaders[I]&&(P+=1);return P/T}n(C,"loadProgress");function v(T){return T!==void 0&&(i.loadRoot=T),i.loadRoot}n(v,"loadRoot");function A(T,P,I,z,M=Tr){let q=new Promise((B,c)=>{let X=Vt(P)?P:i.loadRoot+P;Ot(X).then(H=>{let N=e.makeFont(e.makeTex(H),I,z,M);i.fonts[T]=N,B(N)}).catch(c)});return p(q),q}n(A,"loadFont");function E(T,P,I={sliceX:1,sliceY:1,anims:{}}){function z(q,B,c={sliceX:1,sliceY:1,gridWidth:0,gridHeight:0,anims:{}}){let X=[],H=e.makeTex(B),N=c.sliceX||H.width/(c.gridWidth||H.width),oe=c.sliceY||H.height/(c.gridHeight||H.height),de=1/N,le=1/oe;for(let V=0;V<oe;V++)for(let te=0;te<N;te++)X.push(ne(te*de,V*le,de,le));let w={tex:H,frames:X,anims:c.anims||{}};return i.sprites[q]=w,w}n(z,"loadRawSprite");let M=new Promise((q,B)=>{if(!P)return B(`expected sprite src for "${T}"`);if(typeof P=="string"){let c=Vt(P)?P:i.loadRoot+P;Ot(c).then(X=>{q(z(T,X,I))}).catch(B)}else q(z(T,P,I))});return p(M),M}n(E,"loadSprite");function y(T,P,I,z=!1){function M(B,c,X){let H=e.makeProgram(c,X);return i.shaders[B]=H,H}n(M,"loadRawShader");let q=new Promise((B,c)=>{if(!P&&!I)return c("no shader");function X(H){return H?fetch(i.loadRoot+H).then(N=>{if(N.ok)return N.text();throw new Error(`failed to load ${H}`)}).catch(c):new Promise(N=>N(null))}if(n(X,"resolveUrl"),z)Promise.all([X(P),X(I)]).then(([H,N])=>{B(M(T,H,N))}).catch(c);else try{B(M(T,P,I))}catch(H){c(H)}});return p(q),q}n(y,"loadShader");function _(T,P){let I=i.loadRoot+P,z=new Promise((M,q)=>{if(!P)return q(`expected sound src for "${T}"`);typeof P=="string"&&fetch(I).then(B=>{if(B.ok)return B.arrayBuffer();throw new Error(`failed to load ${I}`)}).then(B=>new Promise((c,X)=>{t.ctx().decodeAudioData(B,c,X)})).then(B=>{i.sounds[T]=B,M(B)}).catch(q)});return p(z),z}n(_,"loadSound");function G(){return i.fonts[Fe]}return n(G,"defFont"),A(Fe,Gt,8,8),{loadRoot:v,loadSprite:E,loadSound:_,loadFont:A,loadShader:y,loadProgress:C,addLoader:p,defFont:G,sprites:i.sprites,fonts:i.fonts,sounds:i.sounds,shaders:i.shaders}}n(Bt,"assetsInit");var Cr=16;function qt(e,t,s={max:8}){var y;let i=[],p=(y=s.max)!=null?y:8;function C(){i.length>p&&(i=i.slice(0,p));let _=l(0,e.height());i.forEach((G,T)=>{let P=Re(T,0,p,1,.5),I=Re(T,0,p,.8,.2),z=(()=>{switch(G.type){case"info":return $(1,1,1,P);case"error":return $(1,0,.5,P)}})(),M=e.fmtText(G.msg,t.defFont(),{pos:_,origin:"botleft",color:z,size:Cr/e.scale(),width:e.width()});e.drawRect(_,M.width,M.height,{origin:"botleft",color:$(0,0,0,I)}),e.drawFmtText(M),_.y-=M.height})}n(C,"draw");function v(_){i.unshift({type:"error",msg:_})}n(v,"error");function A(_){i.unshift({type:"info",msg:_})}n(A,"info");function E(){i=[]}return n(E,"clear"),{info:A,error:v,draw:C,clear:E}}n(qt,"loggerInit");function Ht(e){let t={},s=[],i=null;function p(){return i!==null&&i.readyState===1}n(p,"connected");function C(){let y=new WebSocket(e);return new Promise((_,G)=>{y.onopen=()=>{_(y),i=y;for(let T of s)y.send(T)},y.onerror=()=>{G(`failed to connect to ${e}`)},y.onmessage=T=>{let P=JSON.parse(T.data);if(t[P.type])for(let I of t[P.type])I(P.id,P.data)}})}n(C,"connect");function v(y,_){t[y]||(t[y]=[]),t[y].push(_)}n(v,"recv");function A(y,_){let G=JSON.stringify({type:y,data:_});i?i.send(G):s.push(G)}n(A,"send");function E(){i&&i.close()}return n(E,"close"),{connect:C,close:E,connected:p,recv:v,send:A}}n(Ht,"netInit");var Nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAWCAYAAAA1vze2AAAAAXNSR0IArs4c6QAAALBJREFUSInFlsESwyAIRNlOP5w/pxfjpLgIqTrlJkN8rqtECA8L8j7wa5GZaY2AoY5CfbIMSKBf894HSwAC63O/tszqoi22+4qe36TiHpeiZSXE/LFGJioAlVWFgM492bWFR4w/DmEe/VdJ5dSwb5iPIcRMH4EYoHRPKiBA06P+zlaYgWZ3TFpHOdJWfIPc3oU9YBisghiAJqS16KewCBAmL1gFFP0NqxCR2oMifUx8AEs8Sqk46+g8AAAAAElFTkSuQmCC";var Yt=n(e=>{function t(s="mark"){return e.loadSprite(s,Nt)}return n(t,"loadMark"),{loadMark:t}},"default");var zt=n(e=>{function t(i){let p=new Image;return p.src=i,p.crossOrigin="anonymous",new Promise((C,v)=>{p.onload=()=>{C(p)},p.onerror=()=>{v(`failed to load ${i}`)}})}n(t,"loadImg");function s(i,p){let C=new Promise((v,A)=>{fetch(e.loadRoot()+p).then(E=>E.json()).then(E=>mt(this,null,function*(){let y=yield Promise.all(E.frames.map(t)),_=document.createElement("canvas");_.width=E.width,_.height=E.height*E.frames.length;let G=_.getContext("2d");return y.forEach((T,P)=>{G.drawImage(T,0,P*E.height)}),e.loadSprite(i,_,{sliceY:E.frames.length,anims:E.anims})})).then(v).catch(A)});return e.addLoader(C),C}return n(s,"loadPedit"),{loadPedit:s}},"default");var jt=n(e=>{function t(s,i,p){let C=new Promise((v,A)=>{let E=e.loadRoot()+p;e.loadSprite(s,i).then(y=>{fetch(E).then(_=>_.json()).then(_=>{let G=_.meta.size;y.frames=_.frames.map(T=>e.quad(T.frame.x/G.w,T.frame.y/G.h,T.frame.w/G.w,T.frame.h/G.h));for(let T of _.meta.frameTags)y.anims[T.name]={from:T.from,to:T.to};v(y)}).catch(A)}).catch(A)});return e.addLoader(C),C}return n(t,"loadAseprite"),{loadAseprite:t}},"default");var $t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAoCAYAAAAiyK7sAAAAAXNSR0IArs4c6QAAAv9JREFUeJztWUFyxCAMC53+/8v0lBmXsWTZkKTZossSLIxsIAvkODY+H733zuo9u2Lznj0b4ytaK/rvxBi/kgNbL+vPJqI7UDtng1qtX+1rJVC8mcmr2HUSaBPNtqgf22YmGLZS2URk/VX5SFNlICv9pgSiFYk6Z4lGdsbP2Fbws8jGG/HLnaptvBWZCSKzIhFn5aBkfLFVxNqoMbDFcgse6XQB3qp7Y2PjKbTj+P3qaK21kdR777Z+fNV4thk+q69g1J/lsfwgW5QHJd7It+fHFXY+KzspVo84M2W132izkI2B6fE2Z6viivjfo3Ec+dZaYwFnVtI4461vVG+BZh+qRyuMrc6z72xcyB/izr5pQj/jyLPZ6/G9svcc8ascxTazIj2u9+v1ceWKDAPzGkaJyCQo60fRl7UrvEi/OmCZeBE/Gq+NjY2NjXVQ3t2z/wHWrvhB7b1n1jb7H1PlK3nIxp6OV01cpjMEr63qwyaHlSOdV5RZnLP+0a8t03Mks0UDpqJ37dblhD3nWQ3o7Hkl0Dm4CjUXXr9f1pg5cDO+J1ARpSJ7MYA0ZSYR4p95uHMSnTpsv9+sQVagXfrKDc5oV+5gM2D9Mh2Mb3WOb4SqHnSbNL59Vqz6f4e7X9MbGxsfB7b9tVv7sZ75UfiszSy3wq+2VbmMl7FBLhrItCNiY35XJM2bdGgiWpviJ+Kv0JMBHS8WgCp+ps0MUGBKOeNHHZiKBpYfxLX19BzZe23L+8Th/GqcuRiPDfb3bj32ObzZYfUsAHQDUxEZJYr14emPznPIvzqx75jI3rl240KsGNBPe7u9Cis2NaefFXo23oa3j/xb9KsnA8Qd25y/Xx5pdKRuu5nQiK9ssRGfcStlzx+r88osZnVzgni9k4t0lGQ1wJXl81mpU/Rny8rEiPQr7aN61X4cwYp8GuzbnxJchHFGr/xs5LWvHsUUHfR7ZBbse55Xnw3Mctm3u8h/ZaC8AUb+xxVdvWhZMVmXQhH050Qn8bT+pSvyPwKturvxA/dPrf5XNgQeAAAAAElFTkSuQmCC";var Xt=n(e=>{function t(s="04b03"){return e.loadFont(s,$t,6,8)}return n(t,"load04b03"),{load04b03:t}},"default");var Qt="data:image/png;base64,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";var Wt=n(e=>{function t(s="CP437"){return e.loadFont(s,Qt,9,16," \u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0")}return n(t,"loadCP437"),{loadCP437:t}},"default");var Kt="data:image/png;base64,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";var Zt=n(e=>{function t(s="proggy"){return e.loadFont(s,Kt,7,13)}return n(t,"loadProggy"),{loadProggy:t}},"default");var Z=class extends Map{constructor(...t){super(...t);this.lastID=0}push(t){let s=this.lastID;return this.set(s,t),this.lastID++,s}pushd(t){let s=this.push(t);return()=>this.delete(s)}};n(Z,"IDList");module.exports=(e={width:640,height:480,scale:1,fullscreen:!1,debug:!1,crisp:!1,canvas:null,connect:null,logMax:8,root:document.body})=>{var dt;let t=Mt(),s=Ft({width:e.width,height:e.height,scale:e.scale,fullscreen:e.fullscreen,crisp:e.crisp,canvas:e.canvas,root:e.root,touchToMouse:(dt=e.touchToMouse)!=null?dt:!0,audioCtx:t.ctx()}),i=At(s.gl,{clearColor:e.clearColor?$(e.clearColor):void 0,scale:e.scale,texFilter:e.texFilter}),p=Bt(i,t,{errHandler:r=>{C.error(r)}}),C=qt(i,p,{max:e.logMax}),v=e.connect?Ht(e.connect):null;var A;(function(f){f.AddObj="ADD_OBJ",f.UpdateObj="UPDATE_OBJ",f.DestroyObj="DESTROY_OBJ",f.Disconnect="DISCONNECT"})(A||(A={}));function E(r){if(!v)throw new Error("not connected to any websockets");c.travelers.push(r._id),_(A.AddObj,r._data())}n(E,"sync"),v&&(y(A.AddObj,(r,o)=>{c.visitors[r]||(c.visitors[r]={})}),y(A.DestroyObj,(r,o)=>{if(!c.visitors[r])return;let a=c.visitors[r][o.id];a!=null&&(he(c.objs.get(a)),delete c.visitors[r][o.id])}),y(A.Disconnect,(r,o)=>{if(c.visitors[r]){for(let a of Object.values(c.visitors[r]))he(c.objs.get(a));delete c.visitors[r]}}));function y(r,o){if(!v)throw new Error("not connected to any websockets");v.recv(r,(a,d)=>{o(a,d)})}n(y,"recv");function _(r,o){if(!v)throw new Error("not connected to any websockets");v.send(r,o)}n(_,"send");function G(){return s.dt()*K.timeScale}n(G,"dt");function T(r,o={}){let a=t.play(new AudioBuffer({length:1,numberOfChannels:1,sampleRate:44100}));return Ge(()=>{let d=p.sounds[r];if(!d)throw new Error(`sound not found: "${r}"`);let f=t.play(d,o);for(let h in f)a[h]=f[h]}),a}n(T,"play");function P(r){var o;return!((o=c.layers[r!=null?r:c.defLayer])==null?void 0:o.noCam)}n(P,"isCamLayer");function I(r){return P(r)?c.camMousePos:s.mousePos()}n(I,"mousePos");function z(r,o={}){var f;let a=(()=>typeof r=="string"?p.sprites[r]:r)();if(!a)throw new Error(`sprite not found: "${r}"`);let d=a.frames[(f=o.frame)!=null?f:0];i.drawTexture(a.tex,ve(me({},o),{quad:d.scale(o.quad||ne(0,0,1,1))}))}n(z,"drawSprite");function M(r,o={}){var f;let a=(f=o.font)!=null?f:Fe,d=p.fonts[a];if(!d)throw new Error(`font not found: ${a}`);i.drawText(r,d,o)}n(M,"drawText");let q=980,B="topleft",c={loaded:!1,events:{},objEvents:{},actions:new Z,renders:new Z,objs:new Z,timers:new Z,cam:{pos:l(i.width()/2,i.height()/2),scale:l(1,1),angle:0,shake:0},camMousePos:s.mousePos(),camMatrix:ee(),layers:{},defLayer:null,gravity:q,data:{},travelers:[],visitors:{},on(r,o){return this.events[r]||(this.events[r]=new Z),this.events[r].pushd(o)},trigger(r,...o){this.events[r]&&this.events[r].forEach(a=>a(...o))},scenes:{},paused:!1};function X(r,o){r.forEach((a,d)=>{c.layers[a]={alpha:1,order:d+1,noCam:!1}}),o&&(c.defLayer=o)}n(X,"layers");function H(...r){return r.length>0&&(c.cam.pos=l(...r)),c.cam.pos.clone()}n(H,"camPos");function N(...r){return r.length>0&&(c.cam.scale=l(...r)),c.cam.scale.clone()}n(N,"camScale");function oe(r){return r!==void 0&&(c.cam.angle=r),c.cam.angle}n(oe,"camRot");function de(r){c.cam.shake=r}n(de,"camShake");function le(r){r.forEach(o=>{c.layers[o]&&(c.layers[o].noCam=!0)})}n(le,"camIgnore");let w=new Set(["id","require"]),V=new Set(["add","load","update","draw","destroy","inspect"]);function te(r){let o={},a={},d={},f=[],h={_id:null,hidden:!1,paused:!1,use(u){if(u===void 0)return;let x=typeof u;if(x==="string"){f.push(u);return}if(x!=="object")throw new Error(`invalid comp type: ${x}`);let D=a;u.id&&(o[u.id]={},D=o[u.id]);for(let g in u)if(!w.has(g)){if(typeof u[g]=="function"){let Y=u[g].bind(this);if(V.has(g)){this.on(g,Y);continue}else D[g]=Y}else D[g]=u[g];this[g]||Object.defineProperty(this,g,{get(){return u.id?o[u.id][g]:a[g]},set(Y){u.id?o[u.id][g]=Y:a[g]=Y}})}},c(u){return o[u]},exists(){return this._id!==void 0},is(u){if(u==="*")return!0;if(Array.isArray(u)){for(let x of u)if(!f.includes(x))return!1;return!0}return f.includes(u)},on(u,x){return d[u]||(d[u]=new Z),d[u].pushd(x)},action(u){return this.on("update",u)},trigger(u,...x){d[u]&&d[u].forEach(g=>g.call(this,...x));let D=c.objEvents[u];D&&D.forEach(g=>{this.is(g.tag)&&g.cb(this,...x)})},rmTag(u){let x=f.indexOf(u);x>-1&&f.splice(x,1)},_inspect(){let u=[];if(d.inspect)for(let x of d.inspect.values())u.push(x());return{tags:f,info:u}},destroy(){he(this)}};for(let u of r)h.use(u);h._id=c.objs.push(h),h.trigger("add"),Ge(()=>h.trigger("load"));for(let u in o){let D=o[u].require||[];for(let g of D)if(!h.c(g))throw new Error(`comp '${u}' requires comp '${g}'`)}return h}n(te,"add");function Ce(r){if(!r.exists())return;c.objs.delete(r._id);let o=c.objs.push(r);return r._id=o,r}n(Ce,"readd");function Ue(r,o,a){return c.objEvents[r]||(c.objEvents[r]=new Z),c.objEvents[r].pushd({tag:o,cb:a})}n(Ue,"on");function re(r,o){if(typeof r=="function"&&o===void 0)return c.actions.pushd(r);if(typeof r=="string")return Ue("update",r,o)}n(re,"action");function ge(r,o){if(typeof r=="function"&&o===void 0)return c.renders.pushd(r);if(typeof r=="string")return Ue("update",r,o)}n(ge,"render");function ye(r,o,a){return re(r,d=>{d._checkCollisions(o,f=>{a(d,f)})})}n(ye,"collides");function Ke(r,o,a){return re(r,d=>{d._checkOverlaps(o,f=>{a(d,f)})})}n(Ke,"overlaps");function m(r,o){return re(r,a=>{a.isClicked()&&o(a)})}n(m,"clicks");function U(r,o){return new Promise(a=>{c.timers.push({time:r,cb:()=>{o&&o(),a()}})})}n(U,"wait");function b(r,o){let a=!1,d=n(()=>{a||(o(),U(r,d))},"newF");return d(),()=>a=!0}n(b,"loop");function R(r,o){if(Array.isArray(r)){let a=r.map(d=>R(d,o));return()=>a.forEach(d=>d())}else return c.on("input",()=>s.keyDown(r)&&o())}n(R,"keyDown");function F(r,o){if(Array.isArray(r)){let a=r.map(d=>F(d,o));return()=>a.forEach(d=>d())}else return c.on("input",()=>s.keyPressed(r)&&o())}n(F,"keyPress");function k(r,o){if(Array.isArray(r)){let a=r.map(d=>k(d,o));return()=>a.forEach(d=>d())}else return c.on("input",()=>s.keyPressedRep(r)&&o())}n(k,"keyPressRep");function j(r,o){if(Array.isArray(r)){let a=r.map(d=>j(d,o));return()=>a.forEach(d=>d())}else return c.on("input",()=>s.keyReleased(r)&&o())}n(j,"keyRelease");function L(r){return c.on("input",()=>s.mouseDown()&&r(I()))}n(L,"mouseDown");function S(r){return c.on("input",()=>s.mouseClicked()&&r(I()))}n(S,"mouseClick");function W(r){return c.on("input",()=>s.mouseReleased()&&r(I()))}n(W,"mouseRelease");function O(r){return c.on("input",()=>s.mouseMoved()&&r(I(),s.mouseDeltaPos()))}n(O,"mouseMove");function Q(r){return c.on("input",()=>s.charInputted().forEach(o=>r(o)))}n(Q,"charInput"),s.canvas.addEventListener("touchstart",r=>{[...r.changedTouches].forEach(o=>{c.trigger("touchStart",o.identifier,l(o.clientX,o.clientY).scale(1/s.scale))})}),s.canvas.addEventListener("touchmove",r=>{[...r.changedTouches].forEach(o=>{c.trigger("touchMove",o.identifier,l(o.clientX,o.clientY).scale(1/s.scale))})}),s.canvas.addEventListener("touchmove",r=>{[...r.changedTouches].forEach(o=>{c.trigger("touchEnd",o.identifier,l(o.clientX,o.clientY).scale(1/s.scale))})});function J(r){return c.on("touchStart",r)}n(J,"touchStart");function De(r){return c.on("touchMove",r)}n(De,"touchMove");function ie(r){return c.on("touchEnd",r)}n(ie,"touchEnd");function se(r){let o=[...c.objs.values()].sort((a,d)=>{var u,x,D,g,Y,xe;let f=(D=(x=c.layers[(u=a.layer)!=null?u:c.defLayer])==null?void 0:x.order)!=null?D:0,h=(xe=(Y=c.layers[(g=d.layer)!=null?g:c.defLayer])==null?void 0:Y.order)!=null?xe:0;return f-h});return r?o.filter(a=>a.is(r)):o}n(se,"get");function ae(r,o){if(typeof r=="function"&&o===void 0)return se().map(r);if(typeof r=="string")return se(r).map(o)}n(ae,"every");function Pe(r,o){if(typeof r=="function"&&o===void 0)return se().reverse().map(r);if(typeof r=="string")return se(r).reverse().map(o)}n(Pe,"revery");function he(r){!r.exists()||(r.trigger("destroy"),c.objs.delete(r._id),delete r._id)}n(he,"destroy");function we(r){ae(r,o=>{he(o)})}n(we,"destroyAll");function He(r){return r!==void 0&&(c.gravity=r),c.gravity}n(He,"gravity");function Ne(r){c.trigger("nextFrame"),delete c.events.nextFrame,(r||!K.paused)&&(c.timers.forEach((h,u)=>{h.time-=G(),h.time<=0&&(h.cb(),c.timers.delete(u))}),Pe(h=>{h.paused||h.trigger("update")}),c.actions.forEach(h=>h()));let a=l(i.width(),i.height()),d=c.cam,f=xt(Be(0,Math.PI*2)).scale(d.shake);d.shake=Ve(d.shake,0,5*G()),c.camMatrix=ee().translate(a.scale(.5)).scale(d.scale).rotateZ(d.angle).translate(a.scale(-.5)).translate(d.pos.scale(-1).add(a.scale(.5)).add(f)),ae(h=>{h.hidden||(i.pushTransform(),P(h.layer)&&i.pushMatrix(c.camMatrix),h.trigger("draw"),i.popTransform())}),c.renders.forEach(h=>h())}n(Ne,"gameFrame");function ue(){var h;let r=null,o=p.defFont(),a=$((h=e.inspectColor)!=null?h:[0,1,1,1]);function d(u,x,D){let g=l(4).scale(1/D),Y=i.fmtText(x,o,{size:12/D,pos:u.add(l(g.x,g.y))});i.drawRect(u,Y.width+g.x*2,Y.height+g.x*2,{color:$(0,0,0,1)}),i.drawFmtText(Y)}n(d,"drawInspectTxt");function f(u,x){let D=P(u.layer),g=i.scale()*(D?(c.cam.scale.x+c.cam.scale.y)/2:1);D&&(i.pushTransform(),i.pushMatrix(c.camMatrix)),x(g),D&&i.popTransform()}n(f,"drawObj"),Pe(u=>{!u.area||u.hidden||f(u,x=>{r||u.isHovered()&&(r=u);let D=(r===u?6:2)/x,g=u._worldArea(),Y=g.p2.x-g.p1.x,xe=g.p2.y-g.p1.y;i.drawRectStroke(g.p1,Y,xe,{width:D,color:a})})}),r&&f(r,u=>{let x=I(r.layer),D=[],g=r._inspect();for(let Y of g.tags)D.push(`"${Y}"`);for(let Y of g.info)for(let xe in Y)D.push(`${xe}: ${Y[xe]}`);d(x,D.join(`
`),u)}),d(l(0),s.fps()+"",i.scale())}n(ue,"drawInspect");function Ie(...r){return{id:"pos",pos:l(...r),move(...o){let a=l(...o),d=a.x*G(),f=a.y*G();this.pos.x+=d,this.pos.y+=f},screenPos(){return c.camMatrix.multVec2(this.pos)},inspect(){return{pos:`(${~~this.pos.x}, ${~~this.pos.y})`}}}}n(Ie,"pos");function Le(...r){return r.length===0?Le(1):{id:"scale",scale:l(...r)}}n(Le,"scale");function ke(r){return{id:"rotate",angle:r!=null?r:0}}n(ke,"rotate");function Ye(...r){return{id:"color",color:$(...r)}}n(Ye,"color");function fe(r){return{id:"origin",origin:r}}n(fe,"origin");function Se(r){return{id:"layer",layer:r,inspect(){var o;return{layer:(o=this.layer)!=null?o:c.defLayer}}}}n(Se,"layer");function Me(r,o){var a,d;return((a=r.layer)!=null?a:c.defLayer)===((d=o.layer)!=null?d:c.defLayer)}n(Me,"isSameLayer");function ze(r,o){let a={},d={};return{id:"area",area:{p1:r,p2:o},areaWidth(){let{p1:f,p2:h}=this._worldArea();return h.x-f.x},areaHeight(){let{p1:f,p2:h}=this._worldArea();return h.y-f.y},isClicked(){return s.mouseClicked()&&this.isHovered()},isHovered(){return s.isTouch?s.mouseDown()&&this.hasPt(I(this.layer)):this.hasPt(I(this.layer))},isCollided(f){if(!f.area||!Me(this,f))return!1;let h=this._worldArea(),u=f._worldArea();return tt(h,u)},isOverlapped(f){if(!f.area||!Me(this,f))return!1;let h=this._worldArea(),u=f._worldArea();return Pt(h,u)},clicks(f){this.action(()=>{this.isClicked()&&f()})},hovers(f){this.action(()=>{this.isHovered()&&f()})},collides(f,h){this.action(()=>{this._checkCollisions(f,h)})},overlaps(f,h){this.action(()=>{this._checkOverlaps(f,h)})},hasPt(f){let h=this._worldArea();return St({p1:h.p1,p2:h.p2},f)},pushOut(f){if(f===this||!f.area||!Me(this,f))return null;let h=this._worldArea(),u=f._worldArea();if(!tt(h,u))return null;let x=h.p2.x-u.p1.x,D=u.p2.x-h.p1.x,g=h.p2.y-u.p1.y,Y=u.p2.y-h.p1.y;switch(Math.min(x,D,g,Y)){case x:return this.pos.x-=x,{obj:f,side:"right",dis:-x};case D:return this.pos.x+=D,{obj:f,side:"left",dis:D};case g:return this.pos.y-=g,{obj:f,side:"bottom",dis:-g};case Y:return this.pos.y+=Y,{obj:f,side:"top",dis:Y}}return null},pushOutAll(){return ae(f=>f.solid?this.pushOut(f):null).filter(f=>f!=null)},_checkCollisions(f,h){ae(f,u=>{this!==u&&(a[u._id]||this.isCollided(u)&&(h(u),a[u._id]=u))});for(let u in a){let x=a[u];this.isCollided(x)||delete a[u]}},_checkOverlaps(f,h){ae(f,u=>{this!==u&&(d[u._id]||this.isOverlapped(u)&&(h(u),d[u._id]=u))});for(let u in d){let x=d[u];this.isOverlapped(x)||delete d[u]}},_worldArea(){let f=this.area,h=this.pos||l(0),u=this.scale||l(1),x=h.add(f.p1.scale(u)),D=h.add(f.p2.scale(u));return{p1:l(Math.min(x.x,D.x),Math.min(x.y,D.y)),p2:l(Math.max(x.x,D.x),Math.max(x.y,D.y))}}}}n(ze,"area");function je(r,o,a){let d=l(r,o),f=_e(a||B).scale(d).scale(-.5);return ze(f.sub(d.scale(.5)),f.add(d.scale(.5)))}n(je,"getAreaFromSize");function it(r,o={}){let a=null,d=null;function f(h,u,x,D){let g=l(1,1);return x&&D?(g.x=x/(h.width*u.w),g.y=D/(h.height*u.h)):x?(g.x=x/(h.width*u.w),g.y=g.x):D&&(g.y=D/(h.height*u.h),g.x=g.y),g}return n(f,"calcTexScale"),{id:"sprite",width:0,height:0,animSpeed:o.animSpeed||.1,frame:o.frame||0,quad:o.quad||ne(0,0,1,1),add(){o.noArea||this.use(ze(l(0),l(0)))},load(){if(a=p.sprites[r],!a)throw new Error(`sprite not found: "${r}"`);let h=me({},a.frames[0]);o.quad&&(h=h.scale(o.quad));let u=f(a.tex,h,o.width,o.height);this.width=a.tex.width*h.w*u.x,this.height=a.tex.height*h.h*u.y,o.noArea||this.use(je(this.width,this.height,this.origin))},draw(){z(a,{pos:this.pos,scale:this.scale,rot:this.angle,color:this.color,frame:this.frame,origin:this.origin,quad:this.quad,prog:p.shaders[this.shader],uniform:this.uniform,flipX:o.flipX,flipY:o.flipY,tiled:o.tiled,width:o.width,height:o.height})},update(){if(!d)return;let h=a.anims[d.name];d.timer+=G(),d.timer>=this.animSpeed&&(this.frame++,this.frame>h.to&&(d.loop?this.frame=h.from:(this.frame--,this.stop())),d&&(d.timer-=this.animSpeed))},play(h,u=!0){if(!a){Ge(()=>{this.play(h,u)});return}let x=a.anims[h];if(!x)throw new Error(`anim not found: ${h}`);d&&this.stop(),d={name:h,loop:u,timer:0},this.frame=x.from,this.trigger("animPlay",h)},stop(){if(!d)return;let h=d.name;d=null,this.trigger("animEnd",h)},changeSprite(h){if(!a){Ge(()=>{this.changeSprite(h)});return}if(a=p.sprites[h],!a)throw new Error(`sprite not found: "${h}"`);let u=me({},a.frames[0]);o.quad&&(u.x+=o.quad.x*u.w,u.y+=o.quad.y*u.h,u.w*=o.quad.w,u.h*=o.quad.h),this.width=a.tex.width*u.w,this.height=a.tex.height*u.h,o.noArea||this.use(je(this.width,this.height,this.origin)),d=null,this.frame=0},numFrames(){return a?a.frames.length:0},curAnim(){return d==null?void 0:d.name},flipX(h){o.flipX=h},flipY(h){o.flipY=h},inspect(){let h={};return d&&(h.curAnim=`"${d.name}"`),h}}}n(it,"sprite");function st(r,o,a={}){return{id:"text",text:r,textSize:o||16,font:a.font,width:0,height:0,add(){a.area&&this.use(ze(l(0),l(0)))},load(){var d,f,h;if(a.area){let u=p.fonts[(d=this.font)!=null?d:Fe],x=i.fmtText(this.text+"",u,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:a.width});this.width=x.width/(((f=this.scale)==null?void 0:f.x)||1),this.height=x.height/(((h=this.scale)==null?void 0:h.y)||1),this.use(je(this.width,this.height,this.origin))}},draw(){var h;let d=p.fonts[(h=this.font)!=null?h:Fe],f=i.fmtText(this.text+"",d,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:a.width});this.width=f.width,this.height=f.height,i.drawFmtText(f)}}}n(st,"text");function at(r,o,a={}){return{id:"rect",width:r,height:o,add(){!this.area&&!a.noArea&&this.use(je(this.width,this.height,this.origin))},draw(){i.drawRect(this.pos,this.width,this.height,{scale:this.scale,rot:this.angle,color:this.color,origin:this.origin,prog:p.shaders[this.shader],uniform:this.uniform})}}}n(at,"rect");function $e(){return{id:"solid",solid:!0}}n($e,"solid");let Jt=960,er=480;function Xe(r={}){var h,u;let o=0,a=null,d=null,f=(h=r.maxVel)!=null?h:Jt;return{id:"body",jumpForce:(u=r.jumpForce)!=null?u:er,update(){this.move(0,o);let x=this.pushOutAll(),D=!1;if(a&&(!a.exists()||!this.isCollided(a)?(a=null,d=null,D=!0):d&&(this.pos=this.pos.add(a.pos.sub(d)),d=a.pos.clone())),!a){o=Math.min(o+He()*G(),f);for(let g of x)g.side==="bottom"&&o>0?(a=g.obj,o=0,d=a.pos.clone(),D||this.trigger("grounded",a)):g.side==="top"&&o<0&&(o=0,this.trigger("headbutt",g.obj))}},curPlatform(){return a},grounded(){return a!==null},falling(){return o>0},jump(x){a=null,o=-x||-this.jumpForce}}}n(Xe,"body");function tr(r,o={}){let a=p.shaders[r];return{id:"shader",shader:r,uniform:o}}n(tr,"shader");let K={inspect:!1,timeScale:1,showLog:!0,fps:s.fps,objCount(){return c.objs.size},stepFrame(){Ne(!0)},drawCalls:i.drawCalls,clearLog:C.clear,log:C.info,error:C.error,get paused(){return c.paused},set paused(r){c.paused=r,r?t.ctx().suspend():t.ctx().resume()}};function rr(r,o){return{id:"gridder",gridPos:o.clone(),setGridPos(a){this.gridPos=a.clone(),this.pos=l(r.offset().x+this.gridPos.x*r.gridWidth(),r.offset().y+this.gridPos.y*r.gridHeight())},moveLeft(){this.setGridPos(this.gridPos.add(l(-1,0)))},moveRight(){this.setGridPos(this.gridPos.add(l(1,0)))},moveUp(){this.setGridPos(this.gridPos.add(l(0,-1)))},moveDown(){this.setGridPos(this.gridPos.add(l(0,1)))}}}n(rr,"gridder");function nr(r,o){let a=[],d=l(o.pos||0),f=0,h={offset(){return d.clone()},gridWidth(){return o.width},gridHeight(){return o.height},getPos(...u){let x=l(...u);return l(d.x+x.x*o.width,d.y+x.y*o.height)},spawn(u,x){let D=(()=>{if(Array.isArray(u))return u;if(o[u]){if(typeof o[u]=="function")return o[u]();if(Array.isArray(o[u]))return[...o[u]]}else if(o.any)return o.any(u)})();if(!D)return;D.push(Ie(d.x+x.x*o.width,d.y+x.y*o.height));let g=te(D);return a.push(g),g.use(rr(this,x)),g},width(){return f*o.width},height(){return r.length*o.height},destroy(){for(let u of a)he(u)}};return r.forEach((u,x)=>{let D=u.split("");f=Math.max(D.length,f),D.forEach((g,Y)=>{h.spawn(g,l(Y,x))})}),h}n(nr,"addLevel");function Ze(r){var o,a,d,f;return[Ie((o=r.pos)!=null?o:l(0)),ke((a=r.rot)!=null?a:0),Le(l((d=r.scale)!=null?d:1)),Ye((f=r.color)!=null?f:Te(1,1,1)),fe(r.origin)]}n(Ze,"commonProps");function or(r,o={}){return te([it(r,o),o.body&&Xe(),o.solid&&$e(),o.layer&&Se(o.layer),o.origin&&fe(o.origin),o.data,...Ze(o),...o.tags||[]])}n(or,"addSprite");function ir(r,o,a={}){return te([at(r,o,a),a.body&&Xe(),a.solid&&$e(),a.layer&&Se(a.layer),a.origin&&fe(a.origin),a.data,...Ze(a),...a.tags||[]])}n(ir,"addRect");function sr(r,o,a={}){return te([st(r,o,a),a.body&&Xe(),a.solid&&$e(),a.layer&&Se(a.layer),a.origin&&fe(a.origin),a.data,...Ze(a),...a.tags||[]])}n(sr,"addText");function Ge(r){c.loaded?r():c.on("load",r)}n(Ge,"ready");function ar(r,o){c.scenes[r]=o}n(ar,"scene");function ur(r,...o){c.on("nextFrame",()=>{c.events={},c.objEvents={add:new Z,update:new Z,draw:new Z,destroy:new Z},c.actions=new Z,c.renders=new Z,c.objs=new Z,c.timers=new Z,c.cam={pos:l(i.width()/2,i.height()/2),scale:l(1,1),angle:0,shake:0},c.camMousePos=s.mousePos(),c.camMatrix=ee(),c.layers={},c.defLayer=null,c.gravity=q,c.scenes[r](...o),e.debug&&ct()})}n(ur,"go");function cr(r,o){try{return JSON.parse(window.localStorage[r])}catch(a){return o?(ut(r,o),o):null}}n(cr,"getData");function ut(r,o){window.localStorage[r]=JSON.stringify(o)}n(ut,"setData");function be(r){let o=r(Oe);for(let a in o)Oe[a]=o[a]}n(be,"plug");let Oe={loadRoot:p.loadRoot,loadSprite:p.loadSprite,loadSound:p.loadSound,loadFont:p.loadFont,loadShader:p.loadShader,addLoader:p.addLoader,width:i.width,height:i.height,dt:G,time:s.time,screenshot:s.screenshot,focused:s.focused,focus:s.focus,cursor:s.cursor,ready:Ge,isTouch:()=>s.isTouch,layers:X,camPos:H,camScale:N,camRot:oe,camShake:de,camIgnore:le,gravity:He,add:te,readd:Ce,destroy:he,destroyAll:we,get:se,every:ae,revery:Pe,sync:E,send:_,recv:y,pos:Ie,scale:Le,rotate:ke,color:Ye,origin:fe,layer:Se,area:ze,sprite:it,text:st,rect:at,solid:$e,body:Xe,shader:tr,on:Ue,action:re,render:ge,collides:ye,overlaps:Ke,clicks:m,keyDown:R,keyPress:F,keyPressRep:k,keyRelease:j,mouseDown:L,mouseClick:S,mouseRelease:W,mouseMove:O,charInput:Q,touchStart:J,touchMove:De,touchEnd:ie,mousePos:I,mouseDeltaPos:s.mouseDeltaPos,keyIsDown:s.keyDown,keyIsPressed:s.keyPressed,keyIsPressedRep:s.keyPressedRep,keyIsReleased:s.keyReleased,mouseIsDown:s.mouseDown,mouseIsClicked:s.mouseClicked,mouseIsReleased:s.mouseReleased,mouseIsMoved:s.mouseMoved,loop:b,wait:U,play:T,volume:t.volume,burp:t.burp,audioCtx:t.ctx,makeRng:et,rand:Be,randSeed:Tt,vec2:l,rgb:Te,rgba:$,quad:ne,choose:Dt,chance:Ct,lerp:Ve,map:Re,mapc:bt,wave:vt,deg2rad:Ut,rad2deg:gt,drawSprite:z,drawText:M,drawRect:i.drawRect,drawRectStroke:i.drawRectStroke,drawLine:i.drawLine,drawTri:i.drawTri,debug:K,addLevel:nr,addSprite:or,addRect:ir,addText:sr,scene:ar,go:ur,getData:cr,setData:ut,plug:be};if(be(Yt),be(zt),be(jt),be(Xt),be(Wt),be(Zt),e.plugins&&e.plugins.forEach(be),e.global)for(let r in Oe)window[r]=Oe[r];s.run(()=>{if(i.frameStart(),c.loaded)c.camMousePos=c.camMatrix.invert().multVec2(s.mousePos()),c.trigger("input"),Ne(),K.inspect&&ue(),K.showLog&&C.draw();else{let r=p.loadProgress();if(r===1)c.loaded=!0,c.trigger("load"),v&&v.connect().catch(C.error);else{let o=i.width()/2,a=24/i.scale(),d=l(i.width()/2,i.height()/2).sub(l(o/2,a/2));i.drawRect(l(0),i.width(),i.height(),{color:Te(0,0,0)}),i.drawRectStroke(d,o,a,{width:4/i.scale()}),i.drawRect(d,o*r,a)}}i.frameEnd()});function ct(){F("f1",()=>{K.inspect=!K.inspect}),F("f2",()=>{K.clearLog()}),F("f8",()=>{K.paused=!K.paused,C.info(`${K.paused?"paused":"unpaused"}`)}),F("f7",()=>{K.timeScale=ce(K.timeScale-.2,0,2),C.info(`time scale: ${K.timeScale.toFixed(1)}`)}),F("f9",()=>{K.timeScale=ce(K.timeScale+.2,0,2),C.info(`time scale: ${K.timeScale.toFixed(1)}`)}),F("f10",()=>{K.stepFrame(),C.info("stepped frame")})}return n(ct,"regDebugInput"),e.debug&&ct(),s.focus(),window.addEventListener("error",r=>{C.error(`Error: ${r.error.message}`),s.quit(),s.run(()=>{p.loadProgress()===1&&(i.frameStart(),C.draw(),i.frameEnd())})}),Oe};
//# sourceMappingURL=kaboom.cjs.map
